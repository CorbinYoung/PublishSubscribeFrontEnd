(this["webpackJsonpfrontend-broker"]=this["webpackJsonpfrontend-broker"]||[]).push([[0],{13:function(e,t,a){},14:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),c=a(7),r=a.n(c),i=(a(13),a(1)),o=a(2),l=a(4),u=a(3),p=(a(14),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).renderAllTopics=function(){return e.props.topicsLoaded?0===e.props.topicList.length?s.a.createElement("li",{className:"list-group-item"},"No topics found"):s.a.createElement(s.a.Fragment,null,e.props.topicList.map((function(e){return s.a.createElement("li",{className:"list-group-item",key:e},e)}))):s.a.createElement("p",{style:{color:"#FF0000"}},"Topic loading error")},e}return Object(o.a)(a,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("ul",{className:"list-group"},this.renderAllTopics()),s.a.createElement("div",{className:"pt-3",style:{textAlign:"center"}},s.a.createElement("button",{className:"btn btn-success",onClick:this.props.onUpdate},"Refresh")))}}]),a}(n.Component)),m=a(5),d=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={topicInputValue:"",topicMessage:"",selectedTopic:""},e.handleTopicCreation=function(){e.handlePostRequest("createTopic?topicName="+e.state.topicInputValue)},e.handleTopicDeletion=function(){e.handlePostRequest("deleteTopic?topicName="+e.state.topicInputValue)},e.handlePublishMessage=function(){e.props.topicList.length>0?(0===e.state.selectedTopic.length&&(e.state.selectedTopic=e.props.topicList[0]),e.handlePostRequest("publishMessage?topicName="+e.state.selectedTopic+"&messageContent="+e.state.topicMessage),e.setState({topicMessage:[]})):alert("There are no active topics at this time")},e.handlePostRequest=function(t){fetch(e.props.apiURL+t,{method:"POST"}).then((function(e){return e.json()})).then((function(t){var a=t.success?"Success: ":"Failure: ";a+=t.message,alert(a),e.props.updateTopicList()})).catch((function(e){alert("An error has occured.")}))},e.handleChange=function(t){e.setState(Object(m.a)({},t.target.name,t.target.value))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"card container pt-3 pb-3"},s.a.createElement("div",{className:"modal-header mb-3"},s.a.createElement("h3",{className:"text-center"},"Publisher"),s.a.createElement("button",{type:"button",className:"close","aria-label":"Close",onClick:function(){return e.props.onDelete(e.props.id)}},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"form-inline"},s.a.createElement("label",{className:"pr-1"},"Topic Name "),s.a.createElement("input",{type:"text",className:"form-control mr-1",name:"topicInputValue",value:this.state.topicInputValue,onChange:this.handleChange}),s.a.createElement("button",{className:"btn btn-success mr-1",onClick:this.handleTopicCreation},"Create"),s.a.createElement("button",{className:"btn btn-danger mr-1",onClick:this.handleTopicDeletion},"Delete")),s.a.createElement("br",null),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Message Content"),s.a.createElement("textarea",{className:"form-control",name:"topicMessage",value:this.state.topicMessage,onChange:this.handleChange,rows:"3"}),s.a.createElement("form",{className:"form-inline row mt-1"},s.a.createElement("label",{className:"col-auto"},"Topic"),s.a.createElement("select",{name:"selectedTopic",value:this.state.selectedTopic,onChange:this.handleChange,className:"custom-select col-10"},this.props.topicList.map((function(e){return s.a.createElement("option",{key:e},e)}))),s.a.createElement("button",{className:"btn btn-success ml-1 col-1",style:{float:"right"},onClick:this.handlePublishMessage,type:"button"},"Submit")))))}}]),a}(n.Component),h=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={serverSocket:null,selectedTopic:"",subscriberID:-1,messageArea:[],subscribedArea:[]},e.connectToSocketServer=function(){var t=new WebSocket(e.props.socketURL);t.onopen=function(){console.log("Client socket connected")},t.onmessage=function(t){if(-1===e.state.subscriberID)e.setState({subscriberID:t.data}),console.log("Client socket connected with ID: "+t.data);else{e.state.messageArea.push(e.date.toLocaleTimeString()+" "+t.data),e.forceUpdate();var a=document.getElementById("messageArea");a.scrollTop=a.scrollHeight}},t.onclose=function(){console.log("Client socket disconnected.")},e.setState({serverSocket:t})},e.handleSubscribe=function(){e.state.selectedTopic.length>0?e.handlePostRequest("subscribeToTopic?id="+e.state.subscriberID+"&topicName="+e.state.selectedTopic):alert("Please select a topic")},e.handleUnsubscribe=function(){e.state.selectedTopic.length>0?e.handlePostRequest("unsubscribeToTopic?id="+e.state.subscriberID+"&topicName="+e.state.selectedTopic):alert("Please select a topic")},e.refreshActiveTopics=function(){fetch(e.props.apiURL+"getSubscriberActiveTopics?id="+e.state.subscriberID).then((function(e){return e.json()})).then((function(t){!0===t.success?e.setState({subscribedArea:t.message}):alert("Error refreshing topics")})).catch((function(e){alert("Error refreshing topics")}))},e.handlePostRequest=function(t){fetch(e.props.apiURL+t,{method:"POST"}).then((function(e){return e.json()})).then((function(t){var a=t.success?"Success: ":"Failure: ";a+=t.message,alert(a),e.refreshActiveTopics()})).catch((function(e){alert("An error has occured.")}))},e.handleChange=function(t){e.setState(Object(m.a)({},t.target.name,t.target.value))},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.connectToSocketServer(),this.date=new Date}},{key:"componentWillUnmount",value:function(){this.state.serverSocket.close()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"card container pt-3 pb-3"},s.a.createElement("div",{className:"modal-header mb-3"},s.a.createElement("h3",{className:"text-center"},"Subscriber"),s.a.createElement("button",{type:"button",className:"close","aria-label":"Close",onClick:function(){return e.props.onDelete(e.props.id)}},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"input-group"},s.a.createElement("select",{name:"selectedTopic",value:this.state.selectedTopic,onChange:this.handleChange,onClick:this.props.updateTopicList,className:"custom-select col-10 mr-1"},s.a.createElement("option",{value:!0,hidden:!0},"Choose your topic"),this.props.topicList.map((function(e){return s.a.createElement("option",{key:e},e)}))),s.a.createElement("button",{className:"btn btn-success mr-1",onClick:this.handleSubscribe},"Subscribe"),s.a.createElement("button",{className:"btn btn-danger mr-1",onClick:this.handleUnsubscribe},"Unsubscribe")),s.a.createElement("br",null),s.a.createElement("div",{className:"form-row"},s.a.createElement("div",{className:"form-group col-10"},s.a.createElement("label",null,"Messages"),s.a.createElement("textarea",{className:"form-control",readOnly:!0,rows:"10",value:this.state.messageArea.join("\n"),id:"messageArea"})),s.a.createElement("div",{className:"form-group col-2"},s.a.createElement("label",null,"Subscribed"),s.a.createElement("textarea",{className:"form-control",readOnly:!0,rows:"10",id:"subscribedArea",value:this.state.subscribedArea.join("\n")})))))}}]),a}(n.Component),b=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={apiURL:"http://52.188.147.152:8888/",socketURL:"ws://52.188.147.152:8080/",isTopicsLoaded:!1,topicList:[],subscriberCount:1,publisherCount:2,subscriberList:[{id:0},{id:1}],publisherList:[{id:0},{id:1},{id:2}]},e.handleRetrieveActiveTopics=function(){fetch(e.state.apiURL+"getAllTopicNames").then((function(e){return e.json()})).then((function(t){!0===t.success?e.setState({isTopicsLoaded:!0,topicList:t.message}):e.setState({isTopicsLoaded:!1})})).catch((function(t){e.setState({isTopicsLoaded:!1})}))},e.handleSubscriberAdd=function(){e.state.subscriberList.push({id:e.state.subscriberCount+1}),e.setState({subscriberCount:e.state.subscriberCount+1})},e.handlePublisherAdd=function(){e.state.publisherList.push({id:e.state.publisherCount+1}),e.setState({publisherCount:e.state.publisherCount+1})},e.handlePublisherDelete=function(t){var a=e.state.publisherList.filter((function(e){return e.id!==t}));e.setState({publisherList:a})},e.handleSubscriberDelete=function(t){var a=e.state.subscriberList.filter((function(e){return e.id!==t}));e.setState({subscriberList:a})},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){document.title="Pub Sub",this.handleRetrieveActiveTopics()}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",{className:"text-center"},"Topic List"),s.a.createElement("div",{className:"pt-2 container"},s.a.createElement(p,{topicList:this.state.topicList,topicsLoaded:this.state.isTopicsLoaded,onUpdate:this.handleRetrieveActiveTopics})),s.a.createElement("br",null),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-6"},s.a.createElement("button",{className:"btn btn-primary btn-block mb-2 container",onClick:this.handlePublisherAdd},"Add Publisher"),this.state.publisherList.map((function(t){return s.a.createElement(s.a.Fragment,null,s.a.createElement(d,{apiURL:e.state.apiURL,topicList:e.state.topicList,updateTopicList:e.handleRetrieveActiveTopics,key:t.id,id:t.id,onDelete:e.handlePublisherDelete}),s.a.createElement("br",null))}))),s.a.createElement("div",{className:"col-6"},s.a.createElement("button",{className:"btn btn-primary btn-block mb-2 container",onClick:this.handleSubscriberAdd},"Add Subscriber"),this.state.subscriberList.map((function(t){return s.a.createElement(s.a.Fragment,null,s.a.createElement(h,{className:"col-sm-6",apiURL:e.state.apiURL,socketURL:e.state.socketURL,topicList:e.state.topicList,updateTopicList:e.handleRetrieveActiveTopics,key:t.id,id:t.id,onDelete:e.handleSubscriberDelete}),s.a.createElement("br",null))})))))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(15);r.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a(16)}},[[8,1,2]]]);
//# sourceMappingURL=main.55acda2d.chunk.js.map